{% comment %} {% extends 'store_base.html' %}

{% block header %}
  <h4 class="text-center text-white my-3">Create/Edit Category</h4>
  <nav class="nav">
    <a href="{% url 'custom_admin:admin_home' %}" class="nav-item">Admin Home</a>
  </nav> 
{% endblock header %} {% endcomment %}


        <div class="input-group mb-3" id="category-form">
          <form id="category-form" class="w-100" method="post" enctype="multipart/form-data" data-pk="{{ category.pk }}">
            {% csrf_token %}
            {% comment %} {{category.pk}} {% endcomment %}
            {{ form.as_p }}
            <button type="submit" class="btn btn-primary">Save</button>
            {% comment %} <button type="button" onclick="location.href='{% url 'stores:category' %}'" class="btn btn-warning my-2">Cancel</button> {% endcomment %}
          </form>
        </div>

{% comment %} {% block procat %}
  <h2>Create New Category</h2>
  <form method="post" enctype="multipart/form-data">
    {% csrf_token %}
    {{ form.as_p }}
    <button type="submit" class="btn btn-primary">Save</button>
    <button type="button" onclick="location.href='{% url 'stores:category' %}'" class="btn btn-warning my-2">Cancel</button>
  </form>
{% endblock procat %} {% endcomment %}

<script>
  {% comment %} ---------working code----------- {% endcomment %}
  {% comment %} document.getElementById("category-form").addEventListener("submit", function(event) {
    event.preventDefault(); // prevent the default form submission behavior
  
    const form = event.target; // get the form element
    const formData = new FormData(form); // serialize the form data using the FormData API
    const pk = form.getAttribute("data-pk"); // get the category ID
    alert(pk)
    fetch(`/category/${pk}/update/`, { // send a POST request to the CategoryUpdate view
      method: "POST",
      body: formData,
    })
    .then(response => response.text())
    .then(data => {
      console.log(data)
      document.getElementById("category-form").innerHTML = data; // update the form with the response data
    });
  }); {% endcomment %}
  
</script>